# 수행 목표
마이크로컨트롤러 제어 방식을 학습한다.

# 마이크로컨트롤러로 로봇을 제어하는 방법
## 1.마이크로컨트롤러의 역할
 - 마이크로컨트롤러(MCU)는 로봇, 가전제품, 임베디드 시스템 등에 탑재되어 센서 입력을 받아 처리하고, **엑추에이터를 제어하는 핵심 부품** 이다.  
 - **CPU, 메모리(RAM/ROM), I/O 인터페이스** 를 하나의 칩에 통합하여 외부 환경으로 부터 입력 데이터(센서)를 받고, 제어 명령(모터, LED등)을 출력한다.  
 - 따라서 마이크로컨트롤러는 **실시간 자율 제어 시스템 구현에 필수적인 하드웨어** 이다. 
### 1-1. 센서 및 장치 제어
 - **센서 입력 처리**: 온도, 습도, 거리, 가속도 등 다양한 센서 데이터를 읽는다.(ADC 또는 디지털 신호)
 - **액추에이터 제어**: 모터, LED, 서보 등 장치에 출력 신호를 보내서 동작시킨다.(PWM,GPIO 출력등)
### 1-2. 입출력(I/O) 처리
 - **디지털 입출력(GPIO)핀** 을 통해 외부 장치와 통신한다.
 - **아날로그 입출력(ADC/DAC)** 으로 전압 기반 신호를 처리한다.
### 1-3. 통신 기능 수행
 - **시리얼 통신(UART), I2C, SPI** 등을 이용해 다른 장치(MCU, 센서, 메모리)와 데이터를 송수신한다.
 - 일부 MCU는 **블루투스, 와이파이, CAN** 같은 무선/자동차용 통신 기능도 내장되어 있다.
### 1-4. 실시간 제어(RTOS 또는 인터럽트 기반)
 - **정해진 시간 내에 특정 작업을 반복 수행** (예: 매 10ms마다 온도 측정)
 - **인터럽트를 사용해 긴급한 이벤트 처리 가능** (예: 버튼 입력, 신호 변화 감지 등) 


## 2.기본 제어 방식과 인터페이스(PWM, 아날로그 핀과 디지털 핀)
### 2-1. 기본 제어 방식
 - **디지털 입력**: 버튼, 센서 등으로 부터 HIGH(1)/LOW(0) 신호를 읽는다.(예: 버튼이 눌렸는지 확인)

 - **디지털 출력**: 장치에 HIGH(1)/LOW(0) 신호를 보내서 동작시킨다.(예: LED ON/OFF, 릴레이 작동)

 - **아날로그 입력(ADC)**: 센서 등으로 부터 0~N 범위의 아날로그 전압을 읽어 디지털 값으로 변환한다.(예: 온도센서, 가변저항)

 - **PWM 출력**: 디지털 핀에서 **아날로그처럼 제어 가능한 신호를 생성** 한다.(예:모터 속도 조절, LED밝기 조절)

 - **인터럽트**: 외부 신호가 발생하면 즉시 중단하고 특정 동작을 수행한다.(예: 버튼이 눌리면 즉시 반응)

 - **타이머/카운터**: 주기적인 작업 수행 또는 시간을 측정한다.(예: 1초마다 LED깜빡임)

### 2-2. 인터페이스 종류
1. **디지털 핀(Digital I/O)**
     - HIGH(1, 보통 3.3V이거나 5V), LOW(0, 0V)신호만 처리한다.  
     - 사용 예: LED ON/OFF, 버튼 등  
2. **아날로그 핀(Analog Input, ADC)**
     - 0~100처럼 연속적인 값을 읽어서 디지털 값으로 변환한다. 
     - 사용 예: 조도 센서, 온도 센서, 가변저항 등  
3. **PWM(Pulse Width Modulation, Analog Output 흉내)**
     - 디지털 신호로 **아날로그처럼 동작하게 만드는 방식** 
     - 신호의 ON시간 비율(duty cycle)을 조절하여 전력 세기를 조절한다.
     - 사용 예: LED밝기 조절, 모터 속도 조절, 스피커 음 높이 조절 등


## 3.마이크로컨트롤러의 통신 방식(UART, I2C, SPI등)
### 3-1. UART (Universal Asynchronous Receiver/Transmitter)
 - **TX(Transmit): 데이터 송신, RX(Receive): 데이터 수신, GND: 공통 접지 필요**
 - **2선식 비동기식 직렬 통신** 이다.(클럭 신호 없음, 보레이트 설정 필요)
 - 1:1 연결이 일반적이다.(MCU <--> PC, MCU <--> Bluetooth 등)
 - 속도 조절: **보레이트(예: 9600, 115200 bps)를 맞춰야 한다.**
 - 사용 예: MCU 간 통신에 적합(아두이노 <--> 시리얼 모니터, MCU <--> Bluetooth모듈)
### 3-2. I2C (Inter-Integrated Circuit)
 - **SCL (Clock Line): 클럭 신호, SDA (Data Line): 데이터 송수신, GND**
 - **저속, 2선식 동기식 직렬 통신** 이다.(클럭 기반 통신)
 - **여러 장치를 연결하는 것이 가능** 하다.(주소 체계로 구분)
 - 사용 예: 여러 센서를 하나의 버스로 연결하는 경우(OLED 디스플레이)
### 3-3. SPI (Serial Peripheral Interface)
 - **MOSI(Master Out Slave In)**: 마스터 --> 슬레이브  
 **MISO(Master In Slave Out)**: 슬레이브 --> 마스터  
 **SCLK(Serial Clock)**: 클럭 신호  
 **SS/CS(Slave Select/Chip Select)**: 장치 선택  

 - **고속, 4선식 동기식 직렬 통신**
 - **여러 장치를 연결하는 것이 가능** 하다.(SS로 식별)
 - 슬레이브 장치가 늘어날수록 SS핀 수도 증가한다.
 - 사용 예: 고속 데이터 통신(SD카드, 무선 통신 모듈)


## 4.실시간 제어와 타이머, 타이머의 사용 절차
### 4-1. 실시간 제어
 - 실시간 제어란 **정해진 시간 안에 작업을 완료** 해야 하는 제어 방식이다.  
 - 0.01초마다 센서 값을 읽고, 모터를 조정해야 하는 상황에서 실시간 제어를 하게 된다.  
### 4-2. 타이머
 - MCU에 내장된 정확한 **시간 측정기** 이다.  
     - **시간 측정** (예: 센서 반응 시간 측정)
     - **일정 시간마다 인터럽트 발생** (예: 1초마다 센서값 읽기)
     - **PWM 생성** (예: 모터 속도, LED 밝기 제어)
     - **시간 간격 측정** (예: 통신 시간 초과 감지)
### 4-3. 타이머 사용 절차
1. **타이머 초기 설정**
     - **타이머 선택**: MCU에 여러 타이머가 있는 경우(예: Timer0, Timer1,...) 타이머 선택
     - **프리스케일러 설정**: 클럭 속도를 얼마나 나눌 것인지(속도 조절) 설정
     - **카운트 모드**: 업카운트, 다운카운트, 자동 리로드 등 선택
     - **인터럽트 활성화 여부**: 주기적 동작 시 인터럽트 사용
2. **타이머 시작**
     - **아두이노에서는 간단히  millis(), delay(), timer interrupt 등으로 사용** 한다.
     - **STM32, AVR 등에서는 레지스터 설정을 통해 타이머를 시작** 한다.
3. **인터럽트 서비스 루틴(ISR) 작성**
     - 인터럽트가 발생했을 때 실행할 코드를 작성
4. **주기적인 동작 구현**
     - 인터럽트 안에서 작업 수행(센서 값 읽기, LED 깜빡이기, 모터 제어, 플래그 설정)


## 5.아두이노(마이크로보드의 개념, 아두이노의 개념, 아두이노의 인터페이스 및 통신 방식 등)
### 5-1. 마이크로보드
 - **MCU, 전원, 입출력 인터페이스가 통합된 소형 개발 보드** 이다.  
 - 로봇 제작 및 시제품 개발에서 사용된다.  
### 5-2. 아두이노(Arduino)
 - **하드웨어(마이크로컨트롤러 보드) + 소프트웨어(개발 환경 IDE)가 결합된 오픈소스 플랫폼** 이다. 
 - C++기반이고, 다양한 센서 및 모듈과 호환이 된다. 
 - 아두이노 종류: Arduino Mega(I/O 핀 수 많음, 큰 프로젝트용), Arduino Nano(소형, USB mini-B 사용), Arduino Due(32bit, 고성능 작업에 적합)등이 있다.
### 5-3. 아두이노 인터페이스 및 통신 방식
 - **UART**: 핀(TX, RX), PC<-->아두이노 간 기본 통신, 사용 예(시리얼 모니터)
 - **I2C**: 핀(SDA, SCL), 저속이지만 여러 장치 연결 가능, 사용 예(OLED, 온습도센서)
 - **SPI**: 핀(MISO, MOSI, SCK, SS), 빠른 통신, 슬레이브 직접 선택, 사용 예(SD 카드, TFT 디스플레이)
 - **USB Serial**: 핀(USB), UART 기반 통신, 사용 예(PC ↔ 시리얼 통신)


